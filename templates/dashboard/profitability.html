{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container">
  <h2>ðŸ“ˆ Profitability Dashboard</h2>

  <canvas id="profitChart" height="120"></canvas>

  <h3 class="mt-4">Metrics by Year</h3>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Year</th>
        <th>Revenue</th>
        <th>Gross Margin</th>
        <th>Net Profit</th>
        <th>Depreciation</th>
        <th>Interest Paid</th>
        <th>Income Tax</th>
      </tr>
    </thead>
    <tbody>
      {% for y in years %}
      <tr>
        <td>{{ y }}</td>
        <td>{{ Revenue|index:forloop.counter0 }}</td>
        <td>{{ GrossMargin|index:forloop.counter0 }}</td>
        <td>{{ NetProfit|index:forloop.counter0 }}</td>
        <td>{{ Depreciation|index:forloop.counter0 }}</td>
        <td>{{ InterestPaid|index:forloop.counter0 }}</td>
        <td>{{ IncomeTax|index:forloop.counter0 }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById('profitChart'), {
  type: 'bar',
  data: {
    labels: {{ years|safe }},
    datasets: [
      { label: 'Revenue', data: {{ Revenue|safe }}, backgroundColor: 'blue' },
      { label: 'Gross Margin', data: {{ GrossMargin|safe }}, backgroundColor: 'orange' },
      { label: 'Net Profit', data: {{ NetProfit|safe }}, backgroundColor: 'green' }
    ]
  },
  options: { responsive: true }
});
</script>
{% endblock %}
